version: '3.8'

services:
  mkv-cleaner:
    image: ghcr.io/Praadip91/mkv_url_cleaner:main
    container_name: mkv-url-cleaner
    restart: unless-stopped
    
    volumes:
      # Dossier source contenant les fichiers MKV √† nettoyer
      - ${SOURCE_FOLDER:-/media/videos}:/media
      
      # Dossier de config pour le .env (optionnel)
      - ${CONFIG_FOLDER:-/config}:/config
    
    environment:
      # üëÄ Mode surveillance
      - WATCH_MODE=${WATCH_MODE:-True}
      - WATCH_INTERVAL=${WATCH_INTERVAL:-60}
      
      # üîß Param√®tres de nettoyage
      - ADD_CLEAN_SUFFIX=${ADD_CLEAN_SUFFIX:-True}
      - REMOVE_SITE_PREFIX=${REMOVE_SITE_PREFIX:-True}
      
      # ‚è∞ Planification horaire
      - START_HOUR=${START_HOUR:-3}
      - END_HOUR=${END_HOUR:-5}
      - ENABLE_SCHEDULING=${ENABLE_SCHEDULING:-True}
      
      # üìÅ Dossier source
      - SOURCE_FOLDER=/media
      - CLEANFILE_PATH=/config/cleanfile.txt
    
    # Limites de ressources
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 2G
        reservations:
          cpus: '0.5'
          memory: 512M
    
    # Logs
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
